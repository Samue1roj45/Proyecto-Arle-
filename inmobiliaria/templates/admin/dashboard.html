{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}
<div style="display: grid; justify-content: space-between; align-items: flex-start;">
    <h1 style="margin-bottom: 20px;font-size: 28px;">📊 Dashboard HomeFinder</h1>

    <!-- Tarjetas métricas -->
    <section style="margin-bottom: 10px;">
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px;">
            <div style="background: linear-gradient(135deg,#2563eb,#1d4ed8); color:white; padding:20px; border-radius:12px; text-align:center; box-shadow:0 4px 6px rgba(0,0,0,0.1);" onmouseover=this.style.transform='scale(1.05)' onmouseout="this.style.transform='scale(1)'">
                <h2 style="margin:0; font-size:18px;">🏠 Total Inmuebles</h2>
                <p id="total_inmuebles" style="font-size:28px; font-weight:bold; margin-top:10px;">{{ total_inmuebles }}</p>
            </div>
            <div style="background: linear-gradient(135deg,#16a34a,#15803d); color:white; padding:20px; border-radius:12px; text-align:center; box-shadow:0 4px 6px rgba(0,0,0,0.1);" onmouseover=this.style.transform='scale(1.05)' onmouseout="this.style.transform='scale(1)'">
                <h2 style="margin:0; font-size:18px;">📌 Disponibles</h2>
                <p id="disponibles" style="font-size:28px; font-weight:bold; margin-top:10px;">{{ disponibles }}</p>
            </div>
            <div style="background: linear-gradient(135deg,#dc2626,#991b1b); color:white; padding:20px; border-radius:12px; text-align:center; box-shadow:0 4px 6px rgba(0,0,0,0.1);" onmouseover=this.style.transform='scale(1.05)' onmouseout="this.style.transform='scale(1)'">
                <h2 style="margin:0; font-size:18px;">💰 Vendidos</h2>
                <p id="vendidos" style="font-size:28px; font-weight:bold; margin-top:10px;">{{ vendidos }}</p>
            </div>
            <div style="background: linear-gradient(135deg,#ca8a04,#a16207); color:white; padding:20px; border-radius:12px; text-align:center; box-shadow:0 4px 6px rgba(0,0,0,0.1);" onmouseover=this.style.transform='scale(1.05)' onmouseout="this.style.transform='scale(1)'">
                <h2 style="margin:0; font-size:18px;">🏡 Rentados</h2>
                <p id="rentados" style="font-size:28px; font-weight:bold; margin-top:10px;">{{ rentados }}</p>
            </div>
        </div>

        <!-- Total favoritos -->
        <div style="margin-bottom:30px; padding:20px; background:#f9fafb; border:1px solid #e5e7eb; border-radius:10px;">
            <h2 style="margin:0; font-size:20px;">⭐ Inmueble más agregado a favoritos</h2>
            <p style="font-size:26px; font-weight:bold; color:#2563eb; margin-top:8px;">{{ favorito_top }}</p>
        </div>
    </section>
</div>
<!-- Top inmuebles + Gráfico en 2 columnas -->
<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom:30px;">

    <!-- Top inmuebles -->
    <div style="padding:20px; background:#fff; border:1px solid #e5e7eb; border-radius:10px; box-shadow:0 4px 6px rgba(0,0,0,0.05);">
        <h2 style="margin-bottom:15px;">🏆 Top 5 Inmuebles más favoritos</h2>
        <table style="width:100%; border-collapse: collapse; font-size:15px;">
            <thead>
                <tr style="background:#f3f4f6; text-align:left;">
                    <th style="padding:10px; border-bottom:2px solid #e5e7eb;">Título</th>
                    <th style="padding:10px; border-bottom:2px solid #e5e7eb;">Ciudad</th>
                    <th style="padding:10px; border-bottom:2px solid #e5e7eb;">Favoritos</th>
                </tr>
            </thead>
            <tbody>
                {% for inmueble in top_inmuebles %}
                <tr style="border-bottom:1px solid #e5e7eb;">
                    <td style="padding:10px;">{{ inmueble.titulo }}</td>
                    <td style="padding:10px;">{{ inmueble.ciudad }}</td>
                    <td style="padding:10px; font-weight:bold; color:#2563eb;">{{ inmueble.num_favoritos }}</td>
                </tr>
                {% empty %}
                <tr><td colspan="3" style="padding:15px; text-align:center; color:#6b7280;">No hay datos</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Gráfico -->
    <div style="padding:20px; background:#fff; border:1px solid #e5e7eb; border-radius:10px; box-shadow:0 4px 6px rgba(0,0,0,0.05); display:flex; flex-direction:column; align-items:center; justify-content:center;">
        <h2 style="margin-bottom:15px;">📈 Distribución</h2>
        <div style="width:250px; height:250px;">
            <canvas id="chartInmuebles"></canvas>
        </div>
    </div>

</div>

<!-- Scripts -->
<script src="{% static 'js/chart.umd.min.js' %}"></script>
<script src="{% static 'js/dashboard.js' %}"></script>

{% endblock %}